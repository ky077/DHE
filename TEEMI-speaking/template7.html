<!doctype html>
<html lang="zh-Hans-TW">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="英語文說寫能力檢測平台 英語口說評量系統">
<meta name="author" content="英語文說寫能力檢測平台">
<title>英語口說評量系統 | 英語文說寫能力檢測平台</title>
<link rel="shortcut icon" type="image/x-icon" href="./Content/images/favicon.ico">
<!-- Google Web Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100;300;400;500;700;900&family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap"
      rel="stylesheet">

<!-- Icon Font Stylesheet -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">

<!-- Libraries Stylesheet -->
<link rel="stylesheet" type="text/css" href="Content/widgets/bootstrap-fileinput-5.5.0/css/fileinput.min.css">

<!-- Customized Bootstrap Stylesheet -->
<link rel="stylesheet" type="text/css" href="Content/css/bootstrap.css">

<!-- This web Core Stylesheet -->
<link rel="stylesheet" type="text/css" href="Content/css/styles.css">
</head>

<body>
<a href="#content" title="跳到主要內容" tabindex="1" class="visually-hidden-focusable sr-only-goContent">跳到主要內容</a> 
<div class="page">
  <div class="bg"> </div>
  <div class="header">
    <div class="container">
      <div class="row">
        <div class="col">
          <h1 class="h2"> <span class="h1-1 d-lg-none"><img src="Content/images/TEEMI.svg" alt="TEEMI" height="24"/></span> <span class="h1-1 d-none d-lg-inline me-3"><img src="Content/images/logo_cn-tw.svg" alt="TEEMI" height="48"/></span> <span class="h1-2 text-primary float-end">英語口說評量系統</span> </h1>
        </div>
      </div>
    </div>
  </div>
  <div class="content" id="content"> 
    <!-- ------- ------- ------- ------- ------- ------- ------- -->
    <div class="container">
      <div class="row align-items-start flex-column"> 
        <!-- content:top start -->
        <div class="col-lg-12">
          <h2>
            <div class="part-item">
              <div class="part-num">Part<label class="ms-2">4</label></div>
              <div class="part-content">
                <div class="part-content-title">摘要報告/口頭發表</div>
                <div class="part-content-describe">1.操作/作答說明。<br>
                  2.操作/作答說明。<br>
                  3.操作/作答說明。</div>
              </div>
            </div>
          </h2>
        </div>
        <!-- content:top  end  --> 
        
        <!-- content:middle start -->
        <div class="col-lg-12 col-xl-9 mx-auto px-lg-5 px-xxl-4">
          <h3 class="style-h3">Task 2</h3>
          <div class="px-3 lh-lg">
            <p>情境敘述。情境敘述情境敘述。情境敘述情境敘述情境敘述。情境敘述情境敘述情境敘述情境敘述。情境敘述情境敘述情境敘述。情境敘述情境敘述。情境敘述。</p>
            <div class="row">
              <div class="col-lg-6 mb-3"> <a href="https://placehold.co/1600x900/ADB5BD/FFF?text=RWD image" class="lightboxModal" onClick="return lightboxModal(this)" title="放大檢視圖片"><img src="https://placehold.co/1600x900/ADB5BD/FFF?text=RWD image" class="d-block m-auto w-100" alt=""/></a> </div>
              <div class="col-lg-6 mb-3">
                <div class="ratio ratio-16x9 min-ratio"> 
                  <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/EG0p12xyQX4" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="width: 100%; height: 100%;"></iframe> 
                </div>
              </div>
            </div>
            <p>題目。題目題目。題目題目題目。題目題目題目題目。題目題目題目。題目題目。題目。</p>
            <hr>
            <!-- 上傳檔案 start -->
            <div class="text-center mb-5 mt-5">
              <div class="text-gray-600 mb-2 btn__upload-text">上傳檔案</div>
              <!-- 上傳 start  -->
              <div class="row align-items-center mb-5">
                <div class="col-sm-10 col-md-6 mx-auto"> 
                  <input id="UPLOAD_FILE" name="UPLOAD_FILE" type="file" class="file upload-fileinput" data-browse-on-zone-click="true">
                </div>
                <div class="col-sm-10 col-md-6 mx-auto"> 
                  <input id="UPLOAD_AUDIO" name="UPLOAD_AUDIO" type="file" class="file upload-fileinput" data-browse-on-zone-click="true"> 
                </div>
              </div>
              <!-- 上傳 end --> 
            </div>
            <!-- 上傳檔案 end --> 
          </div>
        </div>
        <!-- content:middle  end  --> 
        
        <!-- content:bottom start -->
        <div class="col-lg-12 py-4 mt-auto text-center"> <span class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="top" title="您必須完成上傳PPT/影音檔案，方可點選按鈕。">
          <button type="button" class="btn btn-primary btn-lg rounded-pill px-5 disabled" id="NEXT" title="完成">完成</button>
          </span> </div>
        <!-- content:bottom  end  --> 
      </div>
    </div>
    <!-- ------- ------- ------- ------- ------- ------- ------- --> 
  </div>
</div>
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- JavaScript Libraries --> 
<script src="Content/js/jquery-3.6.0.min.js"></script> 
<script src="Content/js/bootstrap.bundle.min.js"></script> 

<!-- This web Javascript --> 
<script src="Content/js/main.js"></script> 
<script src="Content/js/demo.js"></script> 
<script src="Content/widgets/bootstrap-fileinput-5.5.0/js/fileinput.min.js"></script> 
<script src="Content/widgets/bootstrap-fileinput-5.5.0/js/locales/zh-TW.js"></script> 
<script src="Content/widgets/bootstrap-fileinput-5.5.0/themes/fa6/theme.js"></script>      
<script>  
    $('#UPLOAD_FILE').fileinput({
        theme: 'fa6',
        language: 'zh-TW', 
        mainClass: 'd-none',
        showClose: false,
        dropZoneTitle: '<i class="fa-solid fa-file-arrow-up" aria-hidden="true"></i><br>點選或拖曳PPT/影音檔案至此<br><small>檔案類型 mp4、ppt、pptx，檔案大小 1MB</small><br><button type="button" class="btn btn-outline-primary btn-lg rounded-pill px-5 mt-3" title="瀏覽">瀏覽</button>',
        dropZoneClickTitle: '',
        allowedFileExtensions: ['mp4', 'ppt', 'pptx'],
        allowedPreviewTypes: ['video', 'office'],
        maxFileSize: 1024, 
        maxFilesNum: 1, 
        autoReplace: true, 
        uploadUrl: "/Content/temp",
        uploadAsync: false,
        layoutTemplates: {
             actions: '<div class="file-actions">\n' +
                        '    <div class="file-footer-buttons">\n' +
                        '      {zoom}{delete}' +
                        '    </div>\n' +
                        '    <div class="clearfix"></div>\n' +
                        '</div>',
        },
        previewSettings: {
            office: {width: '100%', height: '225px'},
            video:  {width: '100%', height: '225px'}
        },
    });
    
    $('#UPLOAD_AUDIO').fileinput({
        theme: 'fa6',
        showClose: false,
        language: 'zh-TW', 
        mainClass: 'd-none',
        showRemove: true,
        dropZoneTitle: '<i class="fa-solid fa-file-audio" aria-hidden="true"></i></i><br>點選或拖曳音檔至此<br><small>檔案類型 mp3、ogg，檔案大小 1MB</small><br><button type="button" class="btn btn-outline-primary btn-lg rounded-pill px-5 mt-3" title="瀏覽">瀏覽</button>',
        dropZoneClickTitle: '',
        allowedFileExtensions: ['mp3', 'ogg'],
        maxFileSize: 1024,
        maxFilesNum: 1, 
        autoReplace: true, 
        uploadUrl: "/Content/temp",
        uploadAsync: false,
        layoutTemplates: {
             actions: '<div class="file-actions">\n' +
                        '    <div class="file-footer-buttons">\n' +
                        '         {delete} ' +
                        '    </div>\n' +
                        '    <div class="clearfix"></div>\n' +
                        '</div>',
            
        }
    });
    
    //上傳錯誤按close時，一併刪除檔案
    $('.upload-fileinput').on('fileuploaderror', function(event, data, msg) {
        $('.kv-error-close').on('click', function() {
            let errorId = $(this).parents('.file-input').find('input[type="file"]').attr('id'); 
            $('#'+errorId).fileinput('clear');
        });
    });
    
    //選PPT/影音檔案後，顯示[完成]按鈕、若有tooltip則清除
    $('#UPLOAD_FILE').on('fileloaded', function(event, file) {
        $('#NEXT').removeClass('disabled').unwrap('[data-bs-toggle="tooltip"]');
        $('.tooltip').remove();
        
        //demo 
        var fileType = file.name.split('.').pop().toLowerCase();
        if(fileType == 'ppt' || fileType == 'pptx'){  
            $('iframe.kv-preview-data.file-preview-office').attr('src', 'https://view.officeapps.live.com/op/view.aspx?src=https://teemi.srenglish.net/speak/test.pptx');
        }
    }); 
    
    $('#UPLOAD_FILE').on('filereset', function(event) {
         $('#NEXT').addClass('disabled');
         $('#NEXT').wrap('<span class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="top" title="您必須完成上傳PPT/影音檔案，方可按完成。"></span>');
                                                       
         //初始化BS Tooltips
         var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
         var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
         }); 
    });
</script>
</body>
</html>
